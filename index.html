<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>CiteCase.in | Supreme Court 2026</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap');
        
        body {
            font-family: 'Inter', sans-serif;
            overscroll-behavior-y: contain;
            background-color: white;
            touch-action: none;
            height: 100vh;
            width: 100vw;
            overflow: hidden;
        }

        .slide-active { 
            opacity: 1; 
            transform: translateY(0); 
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1); 
        }

        .tap-zone {
            position: absolute;
            top: 0;
            height: 100%;
            width: 15%;
            z-index: 10;
        }

        .no-select {
            -webkit-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }

        .btn-action {
            transition: all 0.2s ease;
            position: relative;
            z-index: 60;
        }
        .btn-action:active {
            transform: scale(0.96);
        }

        /* CiteCase Logo Styling */
        .logo-container {
            display: inline-flex;
            font-weight: 800;
            font-size: clamp(2rem, 10vw, 5rem);
            letter-spacing: -0.05em;
        }
        .logo-cite {
            color: black;
            background: white;
            padding: 0 0.15em;
        }
        .logo-case {
            color: white;
            background: black;
            padding: 0 0.2em;
            margin-left: -0.02em;
        }

        .checked-read {
            background-color: #f0fdf4;
            color: #166534;
            border-color: #16a34a !important;
        }

        .filter-chip {
            transition: all 0.2s ease;
            white-space: nowrap;
            z-index: 60;
        }
        .filter-chip.active {
            background-color: black;
            color: white;
            border-color: black;
        }

        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }

        .content-safe-area {
            padding-bottom: 80px;
        }

        .modal-overlay {
            background-color: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(8px);
            transition: opacity 0.3s ease;
        }

        @media (max-width: 480px) {
            .logo-container { font-size: 2.2rem; }
            h2 { font-size: 1.5rem !important; line-height: 1.25 !important; }
        }
    </style>
</head>
<body class="bg-white text-black no-select">

    <!-- Progress Bar -->
    <div class="fixed top-0 left-0 w-full h-1 z-50 bg-gray-50">
        <div id="progress-bar" class="h-full bg-blue-600 transition-all duration-300 w-0"></div>
    </div>

    <!-- Navigation Tap Zones -->
    <div class="tap-zone left-0" onclick="prevSlide()"></div>
    <div class="tap-zone right-0" onclick="nextSlide()"></div>

    <!-- App Container -->
    <div id="app" class="relative h-full w-full flex flex-col items-center">
        
        <!-- Loading State -->
        <div id="loading" class="flex flex-col items-center justify-center h-full">
            <div class="w-10 h-10 border-2 border-gray-100 border-t-black rounded-full animate-spin mb-4"></div>
        </div>

        <!-- Slides Content -->
        <div id="slide-container" class="hidden w-full max-w-4xl h-full flex flex-col justify-center items-center text-center px-4 md:px-12 content-safe-area">
            <div id="slide-content" class="slide-active w-full flex flex-col items-center">
                <!-- Content injected here -->
            </div>
        </div>

        <!-- Controls Footer -->
        <div id="controls" class="hidden fixed bottom-4 md:bottom-8 left-0 w-full px-4 md:px-10 flex justify-between items-center z-50 pointer-events-none">
            <div class="flex items-center gap-1 md:gap-4 pointer-events-auto bg-white/80 backdrop-blur-sm p-1 rounded-full shadow-sm border border-gray-100">
                <button onclick="prevSlide()" id="prev-btn" class="p-2 text-gray-400 hover:text-black disabled:opacity-0 transition-all">
                    <i data-lucide="chevron-left" class="w-6 h-6 md:w-8 md:h-8"></i>
                </button>
                <div id="counter" class="text-[9px] md:text-[10px] font-bold text-gray-400 uppercase tracking-widest px-2">0 / 0</div>
                <button onclick="nextSlide()" id="next-btn" class="p-2 text-gray-400 hover:text-black disabled:opacity-0 transition-all">
                    <i data-lucide="chevron-right" class="w-6 h-6 md:w-8 md:h-8"></i>
                </button>
            </div>
            
            <div class="flex items-center gap-1 md:gap-4 pointer-events-auto bg-white/80 backdrop-blur-sm p-1 rounded-full shadow-sm border border-gray-100">
                <button onclick="skipToSummary()" id="summary-btn" class="p-2 text-gray-400 hover:text-black transition-colors" title="View Summary">
                    <i data-lucide="bar-chart-3" class="w-5 h-5 md:w-6 md:h-6"></i>
                </button>
                <button onclick="toggleBookmarkCurrent()" id="bookmark-footer-btn" class="p-2 text-gray-400 hover:text-black transition-colors">
                    <i data-lucide="bookmark" class="w-5 h-5 md:w-6 md:h-6"></i>
                </button>
                <button onclick="openShareModal()" class="p-2 text-gray-400 hover:text-black transition-colors">
                    <i data-lucide="share" class="w-5 h-5 md:w-6 md:h-6"></i>
                </button>
                <button onclick="resetApp()" class="p-2 text-gray-400 hover:text-black transition-colors">
                    <i data-lucide="home" class="w-5 h-5 md:w-6 md:h-6"></i>
                </button>
            </div>
        </div>

        <!-- Share Modal -->
        <div id="share-modal" class="hidden fixed inset-0 z-[100] modal-overlay flex items-center justify-center p-4">
            <div class="bg-white border border-gray-100 rounded-[2.5rem] shadow-2xl w-full max-w-sm p-8 flex flex-col items-center">
                <h3 class="text-xl font-bold mb-8 text-black">Share Judgment</h3>
                <div class="grid grid-cols-3 gap-y-8 gap-x-4 w-full mb-8">
                    <button onclick="shareToX()" class="flex flex-col items-center gap-2 group">
                        <div class="w-12 h-12 bg-black rounded-2xl flex items-center justify-center text-white group-active:scale-95 transition-transform">
                            <svg viewBox="0 0 24 24" class="w-5 h-5 fill-current"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"></path></svg>
                        </div>
                        <span class="text-[9px] font-bold uppercase tracking-widest text-gray-400">X</span>
                    </button>
                    <button onclick="shareToWhatsApp()" class="flex flex-col items-center gap-2 group">
                        <div class="w-12 h-12 bg-[#25D366] rounded-2xl flex items-center justify-center text-white group-active:scale-95 transition-transform">
                            <i data-lucide="message-circle" class="w-6 h-6"></i>
                        </div>
                        <span class="text-[9px] font-bold uppercase tracking-widest text-gray-400">WhatsApp</span>
                    </button>
                    <button onclick="shareToTelegram()" class="flex flex-col items-center gap-2 group">
                        <div class="w-12 h-12 bg-[#0088cc] rounded-2xl flex items-center justify-center text-white group-active:scale-95 transition-transform">
                            <i data-lucide="send" class="w-6 h-6"></i>
                        </div>
                        <span class="text-[9px] font-bold uppercase tracking-widest text-gray-400">Telegram</span>
                    </button>
                    <button onclick="shareToLinkedIn()" class="flex flex-col items-center gap-2 group">
                        <div class="w-12 h-12 bg-[#0077b5] rounded-2xl flex items-center justify-center text-white group-active:scale-95 transition-transform">
                            <i data-lucide="linkedin" class="w-6 h-6"></i>
                        </div>
                        <span class="text-[9px] font-bold uppercase tracking-widest text-gray-400">LinkedIn</span>
                    </button>
                    <button onclick="shareToFacebook()" class="flex flex-col items-center gap-2 group">
                        <div class="w-12 h-12 bg-[#1877F2] rounded-2xl flex items-center justify-center text-white group-active:scale-95 transition-transform">
                            <i data-lucide="facebook" class="w-6 h-6"></i>
                        </div>
                        <span class="text-[9px] font-bold uppercase tracking-widest text-gray-400">Facebook</span>
                    </button>
                    <button onclick="copyCurrentLink()" class="flex flex-col items-center gap-2 group">
                        <div class="w-12 h-12 bg-gray-100 rounded-2xl flex items-center justify-center text-gray-600 group-active:scale-95 transition-transform">
                            <i data-lucide="link" class="w-6 h-6"></i>
                        </div>
                        <span class="text-[9px] font-bold uppercase tracking-widest text-gray-400">Link</span>
                    </button>
                </div>
                <button onclick="closeShareModal()" class="w-full py-4 bg-gray-50 rounded-2xl font-bold text-gray-500 active:bg-gray-100 transition-colors">Close</button>
            </div>
        </div>

        <!-- Swipe Hint -->
        <div id="swipe-hint" class="hidden fixed bottom-20 md:bottom-28 animate-pulse text-gray-200 pointer-events-none flex flex-col items-center gap-1">
            <i data-lucide="move-right" class="w-4 h-4"></i>
            <span class="text-[7px] uppercase tracking-widest">Swipe</span>
        </div>
    </div>

    <script>
        // Only fetching from daily.md as requested
        const SOURCES = [
            'https://raw.githubusercontent.com/citecase/I/refs/heads/main/daily.md'
        ];
        const STATUS_KEY = 'citecase_2026_read_status';
        const BOOKMARK_KEY = 'citecase_2026_bookmarks';
        
        let allCaseData = []; 
        let slides = [];      
        let currentIndex = 0;
        let touchStartX = 0;
        let touchEndX = 0;
        let touchStartY = 0;
        let touchEndY = 0;
        let readStatus = {};
        let bookmarks = {};
        let activeFilter = 'All';

        const filterOptions = ['All', 'Bookmarks', 'Arbitration', 'CPC', 'CrPC/BNSS', 'IPC', 'Evidence', 'SRA', 'TPA', 'IBC', 'Constitution'];

        async function init() {
            try {
                const responses = await Promise.all(SOURCES.map(url => fetch(url)));
                const texts = await Promise.all(responses.map(res => res.text()));
                
                const mergedMap = new Map();

                texts.forEach(text => {
                    const regex = /\[(.*?)]\((https?:\/\/[^\s)]+)\)/g;
                    let match;
                    while ((match = regex.exec(text)) !== null) {
                        const cleanTitle = match[1].replace(/\\/g, '').trim();
                        const url = match[2];
                        if (!mergedMap.has(url) || cleanTitle.length > mergedMap.get(url).length) {
                            mergedMap.set(url, cleanTitle);
                        }
                    }
                });

                allCaseData = Array.from(mergedMap.entries()).map(([url, title]) => ({ title, url }));

                const cachedStatus = localStorage.getItem(STATUS_KEY);
                if (cachedStatus) {
                    try { readStatus = JSON.parse(cachedStatus); } catch(e) {}
                }
                const cachedBookmarks = localStorage.getItem(BOOKMARK_KEY);
                if (cachedBookmarks) {
                    try { bookmarks = JSON.parse(cachedBookmarks); } catch(e) {}
                }

                buildSlides();

                document.getElementById('loading').classList.add('hidden');
                document.getElementById('slide-container').classList.remove('hidden');
                document.getElementById('controls').classList.remove('hidden');
                
                renderSlide();
                lucide.createIcons();
            } catch (error) {
                console.error('Error fetching data:', error);
                document.getElementById('loading').innerHTML = `<p class="text-red-400">Connection error.</p>`;
            }
        }

        function buildSlides() {
            let filtered = allCaseData;
            if (activeFilter === 'Bookmarks') {
                filtered = allCaseData.filter(c => bookmarks[c.title]);
            } else if (activeFilter !== 'All') {
                const keyword = activeFilter.toLowerCase();
                if (activeFilter === 'CrPC/BNSS') {
                    filtered = allCaseData.filter(c => 
                        c.title.toLowerCase().includes('crpc') || 
                        c.title.toLowerCase().includes('bnss')
                    );
                } else if (activeFilter === 'TPA') {
                    filtered = allCaseData.filter(c => 
                        c.title.toLowerCase().includes('tpa') || 
                        c.title.toLowerCase().includes('transfer of property')
                    );
                } else {
                    filtered = allCaseData.filter(c => c.title.toLowerCase().includes(keyword));
                }
            }

            slides = [
                { title: 'CiteCase', isBranding: true },
                ...filtered,
                { title: 'Summary', isResults: true }
            ];
        }

        function setFilter(f) {
            activeFilter = f;
            currentIndex = 0;
            buildSlides();
            renderSlide();
        }

        function toggleRead(index) {
            const caseTitle = slides[index].title;
            readStatus[caseTitle] = !readStatus[caseTitle];
            localStorage.setItem(STATUS_KEY, JSON.stringify(readStatus));
            renderSlide();
        }

        function toggleBookmarkCurrent() {
            const slide = slides[currentIndex];
            if (!slide || slide.isBranding || slide.isResults) return;
            bookmarks[slide.title] = !bookmarks[slide.title];
            localStorage.setItem(BOOKMARK_KEY, JSON.stringify(bookmarks));
            renderSlide();
        }

        function renderSlide() {
            if (slides.length === 0) return;

            const slide = slides[currentIndex];
            const contentEl = document.getElementById('slide-content');
            const counterEl = document.getElementById('counter');
            const progressEl = document.getElementById('progress-bar');
            const hintEl = document.getElementById('swipe-hint');
            const prevBtn = document.getElementById('prev-btn');
            const nextBtn = document.getElementById('next-btn');
            const bookmarkFooterBtn = document.getElementById('bookmark-footer-btn');

            bookmarkFooterBtn.classList.toggle('hidden', slide.isBranding || slide.isResults);
            if (!slide.isBranding && !slide.isResults) {
                const isBookmarked = bookmarks[slide.title];
                bookmarkFooterBtn.innerHTML = `<i data-lucide="bookmark" class="w-5 h-5 md:w-6 md:h-6 ${isBookmarked ? 'fill-black' : ''}"></i>`;
            }

            contentEl.style.opacity = '0';

            setTimeout(() => {
                if (slide.isBranding) {
                    const caseCount = slides.length - 2;
                    contentEl.innerHTML = `
                        <div class="logo-container mb-4">
                            <span class="logo-cite">Cite</span><span class="logo-case">Case</span>
                        </div>
                        <p class="text-gray-500 font-bold tracking-widest uppercase text-[10px] md:text-xs px-4 mb-8">
                            ${caseCount} Supreme Court Judgments Of 2026
                        </p>
                        
                        <div class="w-full max-w-xs md:max-w-md px-2 overflow-x-auto no-scrollbar pointer-events-auto">
                            <div class="flex flex-wrap gap-2 justify-center">
                                ${filterOptions.map(f => `
                                    <button onclick="setFilter('${f}')" 
                                            class="filter-chip px-3 py-1.5 rounded-full border border-gray-200 text-[10px] md:text-xs font-bold ${activeFilter === f ? 'active' : 'bg-white text-gray-500'}">
                                        ${f}
                                    </button>
                                `).join('')}
                            </div>
                        </div>
                    `;
                    hintEl.classList.toggle('hidden', slides.length <= 1);
                } else if (slide.isResults) {
                    const totalCases = slides.length - 2;
                    const readCount = slides.slice(1, -1).filter(s => readStatus[s.title]).length;
                    contentEl.innerHTML = `
                        <div class="mb-6">
                            <div class="logo-container !text-3xl md:!text-5xl">
                                <span class="logo-cite">Cite</span><span class="logo-case">Case.in</span>
                            </div>
                        </div>
                        <h2 class="text-xl md:text-3xl font-extrabold mb-4 px-4 text-black">Your Summary</h2>
                        <div class="flex flex-col items-center gap-4 px-4">
                            <div class="text-5xl md:text-7xl font-black text-black">${readCount} / ${totalCases}</div>
                            <div class="space-y-1">
                                <p class="text-sm md:text-lg text-gray-600 font-medium">Judgments read.</p>
                                <p class="text-blue-600 text-[10px] font-bold tracking-widest uppercase">Excellent work!</p>
                            </div>
                        </div>
                        <div class="flex gap-3 mt-8 w-full max-w-xs justify-center px-4 pointer-events-auto">
                            <button onclick="currentIndex=0;renderSlide();" class="flex-1 px-4 py-3 bg-black text-white rounded-full font-bold text-xs shadow-md">Start Over</button>
                            <button onclick="resetProgress()" class="px-4 py-3 border border-black text-black rounded-full font-bold text-xs">Reset</button>
                        </div>
                        <div class="mt-6 pointer-events-auto">
                            <a href="https://citecase.in/register" target="_blank" class="btn-action inline-flex items-center gap-2 px-6 py-3 bg-blue-600 text-white rounded-full font-bold text-xs shadow-md">Subscribe <i data-lucide="bell" class="w-4 h-4"></i></a>
                        </div>
                    `;
                    hintEl.classList.add('hidden');
                } else {
                    const isRead = readStatus[slide.title];
                    contentEl.innerHTML = `
                        ${activeFilter !== 'All' ? `<div class="mb-2 text-[9px] font-bold text-blue-600 uppercase tracking-widest">${activeFilter}</div>` : ''}
                        <h2 class="text-xl md:text-4xl font-extrabold leading-tight text-black max-w-3xl mx-auto px-4 mb-8">
                            ${slide.title}
                        </h2>
                        <div class="flex flex-col gap-3 pointer-events-auto w-full max-w-[280px] md:max-w-md">
                            <a href="${slide.url}" target="_blank" class="btn-action inline-flex justify-center items-center gap-2 px-6 py-4 bg-black text-white rounded-full font-bold text-sm shadow-md">Read Judgment <i data-lucide="external-link" class="w-4 h-4"></i></a>
                            <button onclick="toggleRead(${currentIndex})" class="btn-action inline-flex justify-center items-center gap-2 px-6 py-4 border-2 ${isRead ? 'checked-read' : 'border-black'} rounded-full font-bold text-sm">
                                <i data-lucide="${isRead ? 'check-circle' : 'circle'}" class="w-4 h-4"></i>
                                ${isRead ? 'Read Already' : 'Read This?'}
                            </button>
                        </div>
                    `;
                    hintEl.classList.add('hidden');
                }
                
                contentEl.style.opacity = '1';
                counterEl.innerText = `${currentIndex + 1} / ${slides.length}`;
                progressEl.style.width = `${((currentIndex + 1) / slides.length) * 100}%`;
                prevBtn.disabled = currentIndex === 0;
                nextBtn.disabled = currentIndex === slides.length - 1;
                
                lucide.createIcons();
            }, 50);
        }

        function nextSlide() { if (currentIndex < slides.length - 1) { currentIndex++; renderSlide(); } }
        function prevSlide() { if (currentIndex > 0) { currentIndex--; renderSlide(); } }
        function skipToSummary() { currentIndex = slides.length - 1; renderSlide(); }
        function resetApp() { currentIndex = 0; activeFilter = 'All'; buildSlides(); renderSlide(); }

        function resetProgress() {
            if (confirm("Clear all reading progress and bookmarks?")) {
                readStatus = {}; bookmarks = {};
                localStorage.removeItem(STATUS_KEY); localStorage.removeItem(BOOKMARK_KEY);
                renderSlide();
            }
        }

        function openShareModal() {
            const slide = slides[currentIndex];
            if (slide.isBranding || slide.isResults) return;
            document.getElementById('share-modal').classList.remove('hidden');
        }
        function closeShareModal() { document.getElementById('share-modal').classList.add('hidden'); }

        function shareToX() {
            const slide = slides[currentIndex];
            const text = encodeURIComponent(`${slide.title} ${slide.url} via @CiteCase`);
            window.open(`https://twitter.com/intent/tweet?text=${text}`, '_blank');
            closeShareModal();
        }

        function shareToWhatsApp() {
            const slide = slides[currentIndex];
            const text = encodeURIComponent(`*${slide.title}*\nRead Judgment here: ${slide.url}\nin CiteCase.in`);
            window.open(`https://api.whatsapp.com/send?text=${text}`, '_blank');
            closeShareModal();
        }

        function shareToTelegram() {
            const slide = slides[currentIndex];
            const text = encodeURIComponent(`${slide.title} in CiteCase.in`);
            const url = encodeURIComponent(slide.url);
            window.open(`https://t.me/share/url?url=${url}&text=${text}`, '_blank');
            closeShareModal();
        }

        function shareToLinkedIn() {
            const slide = slides[currentIndex];
            const url = encodeURIComponent(slide.url);
            window.open(`https://www.linkedin.com/sharing/share-offsite/?url=${url}`, '_blank');
            closeShareModal();
        }

        function shareToFacebook() {
            const slide = slides[currentIndex];
            const url = encodeURIComponent(slide.url);
            window.open(`https://www.facebook.com/sharer/sharer.php?u=${url}`, '_blank');
            closeShareModal();
        }

        function copyCurrentLink() {
            const slide = slides[currentIndex];
            const text = `${slide.title} ${slide.url} in CiteCase.in`;
            const el = document.createElement('textarea');
            el.value = text;
            document.body.appendChild(el);
            el.select();
            try { document.execCommand('copy'); } catch (err) {}
            document.body.removeChild(el);
            closeShareModal();
        }

        document.addEventListener('touchstart', e => {
            touchStartX = e.changedTouches[0].screenX; touchStartY = e.changedTouches[0].screenY;
        }, {passive: true});

        document.addEventListener('touchend', e => {
            if (e.target.closest('button') || e.target.closest('a') || !document.getElementById('share-modal').classList.contains('hidden')) return;
            touchEndX = e.changedTouches[0].screenX; touchEndY = e.changedTouches[0].screenY;
            const threshold = 40;
            const deltaX = touchStartX - touchEndX; const deltaY = touchStartY - touchEndY;
            if (Math.abs(deltaX) > Math.abs(deltaY)) {
                if (deltaX > threshold) nextSlide(); else if (deltaX < -threshold) prevSlide();
            } else {
                if (deltaY > threshold) nextSlide(); else if (deltaY < -threshold) prevSlide();
            }
        }, false);

        document.addEventListener('keydown', e => {
            if (e.key === 'ArrowRight' || e.key === 'ArrowDown' || e.key === ' ') nextSlide();
            if (e.key === 'ArrowLeft' || e.key === 'ArrowUp') prevSlide();
            if (e.key === 'Escape') closeShareModal();
        });

        window.onload = init;
    </script>
</body>
</html>
