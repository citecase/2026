<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>CiteCase.in | Supreme Court 2026</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap');
        
        body {
            font-family: 'Inter', sans-serif;
            overscroll-behavior-y: contain;
            background-color: white;
            touch-action: none; /* Prevents browser pull-to-refresh during swipes */
        }

        .slide-active { 
            opacity: 1; 
            transform: translateY(0); 
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1); 
        }

        .tap-zone {
            position: absolute;
            top: 0;
            height: 100%;
            width: 15%;
            z-index: 40;
        }

        .no-select {
            -webkit-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }

        .btn-action {
            transition: all 0.3s ease;
        }
        .btn-action:hover {
            transform: translateY(-2px);
        }

        /* CiteCase Logo Styling */
        .logo-container {
            display: inline-flex;
            font-weight: 800;
            font-size: clamp(3rem, 10vw, 6rem);
            letter-spacing: -0.05em;
        }
        .logo-cite {
            color: black;
            background: white;
            padding: 0 0.15em;
        }
        .logo-case {
            color: white;
            background: black;
            padding: 0 0.2em;
            margin-left: -0.02em;
        }

        .checked-read {
            background-color: #f0fdf4;
            color: #166534;
            border-color: #16a34a !important;
        }
    </style>
</head>
<body class="bg-white text-black overflow-hidden h-screen w-screen no-select">

    <!-- Progress Bar -->
    <div class="fixed top-0 left-0 w-full h-1.5 z-50 bg-gray-50">
        <div id="progress-bar" class="h-full bg-blue-600 transition-all duration-300 w-0"></div>
    </div>

    <!-- Navigation Tap Zones (For desktop clicks) -->
    <div class="tap-zone left-0" onclick="prevSlide()"></div>
    <div class="tap-zone right-0" onclick="nextSlide()"></div>

    <!-- App Container -->
    <div id="app" class="relative h-full w-full flex flex-col items-center justify-center p-6 md:p-24">
        
        <!-- Loading State -->
        <div id="loading" class="flex flex-col items-center">
            <div class="w-10 h-10 border-2 border-gray-100 border-t-black rounded-full animate-spin mb-4"></div>
        </div>

        <!-- Slides Content -->
        <div id="slide-container" class="hidden w-full max-w-5xl h-full flex flex-col justify-center items-center text-center">
            <div id="slide-content" class="slide-active w-full flex flex-col items-center">
                <!-- Content injected here -->
            </div>
        </div>

        <!-- Controls Footer -->
        <div id="controls" class="hidden fixed bottom-10 left-0 w-full px-6 md:px-10 flex justify-between items-center z-50 pointer-events-none">
            <div class="flex items-center gap-3 md:gap-8 pointer-events-auto">
                <button onclick="prevSlide()" id="prev-btn" class="p-2 text-gray-300 hover:text-black disabled:opacity-0 transition-all">
                    <i data-lucide="chevron-left" class="w-8 h-8"></i>
                </button>
                <div id="counter" class="text-[10px] font-bold text-gray-400 uppercase tracking-[0.3em]">0 / 0</div>
                <button onclick="nextSlide()" id="next-btn" class="p-2 text-gray-300 hover:text-black disabled:opacity-0 transition-all">
                    <i data-lucide="chevron-right" class="w-8 h-8"></i>
                </button>
            </div>
            
            <div class="flex items-center gap-3 md:gap-6 pointer-events-auto">
                <button onclick="skipToSummary()" id="summary-btn" class="p-2 text-gray-300 hover:text-black transition-colors" title="View Summary">
                    <i data-lucide="bar-chart-3" class="w-5 h-5"></i>
                </button>
                <button onclick="shareCase()" class="p-2 text-gray-300 hover:text-black transition-colors">
                    <i data-lucide="share" class="w-5 h-5"></i>
                </button>
                <button onclick="resetApp()" class="p-2 text-gray-300 hover:text-black transition-colors">
                    <i data-lucide="home" class="w-5 h-5"></i>
                </button>
            </div>
        </div>

        <!-- Swipe Hint -->
        <div id="swipe-hint" class="hidden fixed bottom-32 animate-pulse text-gray-200 pointer-events-none flex flex-col items-center gap-1">
            <i data-lucide="move-right" class="w-5 h-5"></i>
            <span class="text-[8px] uppercase tracking-widest">Swipe any direction</span>
        </div>
    </div>

    <script>
        const DATA_URL = 'https://raw.githubusercontent.com/citecase/I/refs/heads/main/list.md';
        const STORAGE_KEY = 'citecase_2026_read_status';
        let slides = [];
        let currentIndex = 0;
        let touchStartX = 0;
        let touchEndX = 0;
        let touchStartY = 0;
        let touchEndY = 0;
        let readStatus = {};

        async function init() {
            try {
                const response = await fetch(DATA_URL);
                const text = await response.text();
                
                const lines = text.split(/\r?\n/);
                const caseData = [];

                lines.forEach(line => {
                    const match = line.match(/\[([^\]]+)\]\((https?:\/\/[^\s)]+)\)/);
                    if (match) {
                        const cleanTitle = match[1].replace(/\\/g, '').trim();
                        caseData.push({ title: cleanTitle, url: match[2] });
                    }
                });

                slides = [
                    { title: 'CiteCase', isBranding: true },
                    ...caseData,
                    { title: 'Summary', isResults: true }
                ];
                
                const cached = localStorage.getItem(STORAGE_KEY);
                if (cached) {
                    try {
                        readStatus = JSON.parse(cached);
                    } catch(e) {
                        console.error("Cache error", e);
                    }
                }

                document.getElementById('loading').classList.add('hidden');
                document.getElementById('slide-container').classList.remove('hidden');
                document.getElementById('controls').classList.remove('hidden');
                
                renderSlide();
                lucide.createIcons();
            } catch (error) {
                console.error('Error fetching data:', error);
                document.getElementById('loading').innerHTML = `<p class="text-red-400">Error loading data.</p>`;
            }
        }

        function saveStatus() {
            localStorage.setItem(STORAGE_KEY, JSON.stringify(readStatus));
        }

        function toggleRead(index) {
            readStatus[index] = !readStatus[index];
            saveStatus();
            renderSlide();
        }

        function skipToSummary() {
            currentIndex = slides.length - 1;
            renderSlide();
        }

        function renderSlide() {
            if (slides.length === 0) return;

            const slide = slides[currentIndex];
            const contentEl = document.getElementById('slide-content');
            const counterEl = document.getElementById('counter');
            const progressEl = document.getElementById('progress-bar');
            const hintEl = document.getElementById('swipe-hint');
            const prevBtn = document.getElementById('prev-btn');
            const nextBtn = document.getElementById('next-btn');
            const summaryBtn = document.getElementById('summary-btn');

            contentEl.style.opacity = '0';

            setTimeout(() => {
                if (slide.isBranding) {
                    const totalCount = slides.length - 2;
                    contentEl.innerHTML = `
                        <div class="logo-container">
                            <span class="logo-cite">Cite</span><span class="logo-case">Case</span>
                        </div>
                        <p class="mt-8 text-gray-500 font-semibold tracking-[0.2em] uppercase text-xs md:text-sm">
                            ${totalCount} Supreme Court Judgments Of 2026
                        </p>
                    `;
                    hintEl.classList.toggle('hidden', slides.length <= 1);
                    summaryBtn.classList.remove('hidden');
                } else if (slide.isResults) {
                    const totalCases = slides.length - 2;
                    const readCount = Object.values(readStatus).filter(v => v).length;
                    contentEl.innerHTML = `
                        <h2 class="text-3xl md:text-5xl font-extrabold mb-8">Reading Summary</h2>
                        <div class="flex flex-col items-center gap-6">
                            <div class="text-6xl md:text-8xl font-black text-black leading-none">${readCount} / ${totalCases}</div>
                            <div class="space-y-2 px-4">
                                <p class="text-xl md:text-2xl text-gray-700 font-medium">You have read ${readCount}/${totalCases} judgments in this.</p>
                                <p class="text-blue-600 text-lg font-bold tracking-widest uppercase">Keep it up!</p>
                            </div>
                        </div>
                        <div class="flex flex-col sm:flex-row gap-4 mt-12 w-full max-w-xs sm:max-w-none justify-center px-4">
                            <button onclick="resetProgress()" class="px-10 py-4 border-2 border-black text-black rounded-full font-bold hover:bg-gray-50 transition-all text-center">
                                Reset Progress
                            </button>
                            <button onclick="currentIndex=0;renderSlide();" class="px-10 py-4 bg-black text-white rounded-full font-bold hover:scale-105 transition-all shadow-lg text-center">
                                Back to Start
                            </button>
                        </div>
                    `;
                    hintEl.classList.add('hidden');
                    summaryBtn.classList.add('hidden');
                } else {
                    const isRead = readStatus[currentIndex];
                    contentEl.innerHTML = `
                        <h2 class="text-3xl md:text-5xl font-extrabold leading-tight tracking-tight text-black max-w-4xl mx-auto px-4 mb-10">
                            ${slide.title}
                        </h2>
                        
                        <div class="flex flex-wrap justify-center gap-4 pointer-events-auto px-4">
                            <a href="${slide.url}" target="_blank" rel="noopener noreferrer" 
                               class="btn-action flex-1 sm:flex-none inline-flex justify-center items-center gap-2 px-8 py-4 bg-black text-white rounded-full font-bold text-lg hover:bg-gray-800 shadow-md">
                               Read Case <i data-lucide="external-link" class="w-5 h-5"></i>
                            </a>
                            
                            <button onclick="toggleRead(${currentIndex})" 
                                    class="btn-action flex-1 sm:flex-none inline-flex justify-center items-center gap-2 px-8 py-4 border-2 ${isRead ? 'checked-read' : 'border-black'} rounded-full font-bold text-lg shadow-sm">
                                <i data-lucide="${isRead ? 'check-circle' : 'circle'}" class="w-5 h-5"></i>
                                ${isRead ? 'Read Already' : 'Mark as Read'}
                            </button>
                        </div>
                    `;
                    hintEl.classList.add('hidden');
                    summaryBtn.classList.remove('hidden');
                }
                
                contentEl.style.opacity = '1';
                
                counterEl.innerText = `${currentIndex + 1} / ${slides.length}`;
                progressEl.style.width = `${((currentIndex + 1) / slides.length) * 100}%`;
                
                prevBtn.disabled = currentIndex === 0;
                nextBtn.disabled = currentIndex === slides.length - 1;
                
                lucide.createIcons();
            }, 100);
        }

        function nextSlide() {
            if (currentIndex < slides.length - 1) {
                currentIndex++;
                renderSlide();
            }
        }

        function prevSlide() {
            if (currentIndex > 0) {
                currentIndex--;
                renderSlide();
            }
        }

        function resetProgress() {
            if (confirm("Clear all reading progress?")) {
                readStatus = {};
                localStorage.removeItem(STORAGE_KEY);
                renderSlide();
            }
        }

        function resetApp() {
            currentIndex = 0;
            renderSlide();
        }

        async function shareCase() {
            const slide = slides[currentIndex];
            if (slide.isBranding || slide.isResults) return;
            const text = `${slide.title} - CiteCase.in`;
            const url = slide.url || window.location.href;
            
            if (navigator.share) {
                try {
                    await navigator.share({ title: 'CiteCase', text: text, url: url });
                } catch (err) {
                    if (err.name !== 'AbortError') console.error('Share failed:', err);
                }
            } else {
                const el = document.createElement('textarea');
                el.value = `${text} ${url}`;
                document.body.appendChild(el);
                el.select();
                try { document.execCommand('copy'); } catch (err) {}
                document.body.removeChild(el);
            }
        }

        // Multi-Directional Swipe Handling
        document.addEventListener('touchstart', e => {
            touchStartX = e.changedTouches[0].screenX;
            touchStartY = e.changedTouches[0].screenY;
        }, false);

        document.addEventListener('touchend', e => {
            touchEndX = e.changedTouches[0].screenX;
            touchEndY = e.changedTouches[0].screenY;
            
            const threshold = 50;
            const deltaX = touchStartX - touchEndX;
            const deltaY = touchStartY - touchEndY;

            if (e.target.closest('button') || e.target.closest('a')) return;

            // Determine if horizontal or vertical displacement is greater
            if (Math.abs(deltaX) > Math.abs(deltaY)) {
                // Horizontal swipes
                if (deltaX > threshold) nextSlide();
                else if (deltaX < -threshold) prevSlide();
            } else {
                // Vertical swipes
                if (deltaY > threshold) nextSlide();
                else if (deltaY < -threshold) prevSlide();
            }
        }, false);

        document.addEventListener('keydown', e => {
            if (e.key === 'ArrowRight' || e.key === 'ArrowDown' || e.key === ' ') nextSlide();
            if (e.key === 'ArrowLeft' || e.key === 'ArrowUp') prevSlide();
        });

        window.onload = init;
    </script>
</body>
</html>
